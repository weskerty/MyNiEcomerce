<style>
#bl-wrap *{box-sizing:border-box}
.bl-nb{position:absolute;top:0;font-size:1.8rem;text-decoration:none;z-index:10}
.bl-nb-l{left:0}
.bl-nb-r{right:0}
.bl-head{margin-bottom:clamp(16px,3vw,32px)}
.bl-head h1{font-size:clamp(1.6rem,5vw,2.8rem);font-weight:700;color:rgba(255,255,255,.95);letter-spacing:-.02em;text-shadow:0 2px 20px rgba(0,0,0,.3);line-height:1.1;border-bottom:2px solid #1a73e8;padding-bottom:.5rem;display:inline-block}
.bl-head p{font-size:.8rem;color:rgba(255,255,255,.5);margin-top:5px;font-weight:300;letter-spacing:.06em;text-transform:uppercase}
.bl-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(min(100%,300px),1fr));gap:16px}
.bl-card{position:relative;border-radius:20px;overflow:hidden;cursor:pointer;text-decoration:none;display:block;min-height:200px;background:rgba(255,255,255,.1);border:1px solid rgba(255,255,255,.2);box-shadow:0 4px 24px rgba(0,0,0,.15),inset 0 1px 0 rgba(255,255,255,.15);transition:transform .3s cubic-bezier(.2,.8,.2,1),box-shadow .3s ease;will-change:transform}
.bl-card:hover{transform:translateY(-5px) scale(1.01);box-shadow:0 16px 40px rgba(0,0,0,.25),inset 0 1px 0 rgba(255,255,255,.2);text-decoration:none}
.bl-card:active{transform:scale(.98)}
.bl-bg{position:absolute;inset:0;background-size:cover;background-position:center;transition:transform .4s cubic-bezier(.2,.8,.2,1),filter .3s ease;filter:brightness(.5) saturate(1.2)}
.bl-card:hover .bl-bg{transform:scale(1.05);filter:brightness(.4) saturate(1.4)}
.bl-bg-none{background:linear-gradient(135deg,rgba(255,255,255,.07),rgba(255,255,255,.02))}
.bl-gloss{position:absolute;top:0;left:0;right:0;height:50%;background:linear-gradient(180deg,rgba(255,255,255,.1) 0%,transparent 100%);pointer-events:none;border-radius:20px 20px 0 0}
.bl-body{position:relative;z-index:2;padding:20px 18px 18px;display:flex;flex-direction:column;justify-content:flex-end;min-height:200px}
.bl-cat{font-size:.68rem;font-weight:500;letter-spacing:.12em;text-transform:uppercase;color:rgba(255,255,255,.5);margin-bottom:7px;display:flex;align-items:center;gap:5px}
.bl-cat::before{content:'';display:inline-block;width:14px;height:1px;background:rgba(255,255,255,.35)}
.bl-title{font-family:'Libre Baskerville','Merriweather','Times New Roman','Georgia',serif;font-size:clamp(1rem,2.5vw,1.3rem);font-weight:700;color:rgba(255,255,255,.95);line-height:1.25;text-shadow:0 2px 10px rgba(0,0,0,.4)}
.bl-arr{position:absolute;bottom:18px;right:18px;width:32px;height:32px;border-radius:50%;background:rgba(255,255,255,.12);border:1px solid rgba(255,255,255,.2);display:flex;align-items:center;justify-content:center;color:rgba(255,255,255,.85);font-size:13px;transition:transform .25s cubic-bezier(.2,.8,.2,1),background .25s ease}
.bl-card:hover .bl-arr{transform:translate(2px,-2px);background:rgba(255,255,255,.22)}
.bl-wide{grid-column:1/-1;min-height:260px}
.bl-wide .bl-body{min-height:260px}
.bl-wide .bl-title{font-size:clamp(1.2rem,4vw,1.8rem)}
.bl-empty{grid-column:1/-1;text-align:center;padding:50px 20px;color:rgba(255,255,255,.4)}
.bl-empty span{display:block;font-size:2rem;margin-bottom:10px}
.bl-dots{display:flex;align-items:center;justify-content:center;gap:7px;padding:50px}
.bl-dot{width:7px;height:7px;border-radius:50%;background:rgba(255,255,255,.4);animation:blP .8s ease-in-out infinite}
.bl-dot:nth-child(2){animation-delay:.15s}
.bl-dot:nth-child(3){animation-delay:.3s}
@keyframes blP{0%,100%{opacity:.25;transform:scale(.8)}50%{opacity:1;transform:scale(1.1)}}
@media(max-width:480px){.bl-grid{grid-template-columns:1fr}.bl-wide{min-height:220px}}
</style>

<a class="bl-nb bl-nb-l" href="web/es.html">üè†</a>
<a class="bl-nb bl-nb-r" href="web/search.html">üîç</a>

<div style="text-align:center">
<div id="bl-wrap">
<div class="bl-head">
<h1>Blog</h1>
<div class="section">
    <div class="gallery-container">
        <div id="BPinned-gallery" 
             class="contenedor-imagenes-animado">
        </div>
        
    </div>
</div>
<p id="bl-cnt"></p>
</div>
<div class="bl-dots" id="bl-ld"><div class="bl-dot"></div><div class="bl-dot"></div><div class="bl-dot"></div></div>
<div class="bl-grid" id="bl-gr" style="display:none"></div>
</div>
</div>

<script>
(function(){
const DJ='web/Dinamico/data.json';
const PAGE=30;

let curList=[],curOff=0,io=null,imgIO=null;

function fN(p){return p.split('/').pop().replace(/\.[^.]+$/,'')}
function mL(p){return p.replace(/\.[^.]+$/,'.md')}
function nN(n){const m=n.match(/NB=([^.]+)/);return m?m[1].trim():n.replace(/-/g,' ')}

async function fD(){
const r=await fetch(DJ).catch(()=>null);
if(!r||!r.ok)return[];
const d=await r.json().catch(()=>null);
const bl=d&&d.galleries&&d.galleries.Blogs;
if(!bl)return[];
const out=[];
const sub=typeof bl==='object'&&!Array.isArray(bl)?bl:{_r:Array.isArray(bl)?bl:[]};
Object.keys(sub).forEach(function(k){
const arr=sub[k];if(!Array.isArray(arr))return;
arr.forEach(function(p){
if(typeof p!=='string')return;
out.push({img:p,md:mL(p),name:nN(fN(p)),cat:k==='_r'?'Blog':k});
});
});
return out;
}

function mk(item,idx){
const a=document.createElement('a');
a.href=item.md;
a.className='bl-card'+(idx===0?' bl-wide':'');
const bg=document.createElement('div');
bg.className='bl-bg'+(item.img?'':' bl-bg-none');
if(item.img)bg.dataset.bg=item.img;
const gl=document.createElement('div');gl.className='bl-gloss';
const bd=document.createElement('div');bd.className='bl-body';
bd.innerHTML='<div class="bl-cat">'+item.cat+'</div><div class="bl-title">'+item.name+'</div>';
const ar=document.createElement('div');ar.className='bl-arr';ar.textContent='‚Üó';
a.append(bg,gl,bd,ar);
return a;
}

function setupImgIO(){
if(imgIO)imgIO.disconnect();
imgIO=new IntersectionObserver(entries=>{
entries.forEach(e=>{
if(!e.isIntersecting)return;
const bg=e.target;
const url=bg.dataset.bg;
if(url){
bg.style.backgroundImage='url('+encodeURI(url)+')';
delete bg.dataset.bg;
}
imgIO.unobserve(bg);
});
},{rootMargin:'100px'});
}

function mkSentinel(){
const d=document.createElement('div');
d.id='bl-sentinel';
d.style.height='1px';
d.style.gridColumn='1/-1';
return d;
}

function appendPage(gr,list,off){
const slice=list.slice(off,off+PAGE);
if(!slice.length)return off;
slice.forEach((item,i)=>{
const card=mk(item,off+i);
gr.appendChild(card);
const bg=card.querySelector('.bl-bg[data-bg]');
if(bg)imgIO.observe(bg);
});
return off+slice.length;
}

function setupIO(gr,list){
if(io)io.disconnect();
let sent=document.getElementById('bl-sentinel');
if(!sent){sent=mkSentinel();gr.appendChild(sent);}
io=new IntersectionObserver(entries=>{
if(!entries[0].isIntersecting)return;
if(curOff>=list.length){io.disconnect();sent.remove();return;}
curOff=appendPage(gr,list,curOff);
if(curOff>=list.length){io.disconnect();sent.remove();}
},{rootMargin:'300px'});
io.observe(sent);
}

async function init(){
const gr=document.getElementById('bl-gr');
const ld=document.getElementById('bl-ld');
const cnt=document.getElementById('bl-cnt');
if(!gr)return;
gr.innerHTML='';
const items=await fD();
if(ld)ld.style.display='none';
gr.style.display='';
if(!items.length){
gr.innerHTML='<div class="bl-empty"><span>üì≠</span>Sin art√≠culos por ahora</div>';
return;
}
if(cnt)cnt.textContent=items.length+(items.length===1?' art√≠culo':' art√≠culos');
curList=items;curOff=0;
setupImgIO();
curOff=appendPage(gr,items,curOff);
if(curOff<items.length)setupIO(gr,items);
}
init();
})();
</script>
